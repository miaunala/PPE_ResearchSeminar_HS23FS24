---
title: "202404_PrimaryResults_PPE_NG"
output: html_document
date: "2024-04-20"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
setwd("C:/Users/whatt/iCloudDrive/UZH/Master/FS24/Polito/PPE")

library(ggplot2)
library(readr)
library(dplyr)
```

```{r}
dataset_ppe <- read_csv("country.csv")

names(dataset_ppe)

names(dataset_ppe)[names(dataset_ppe) == "Country"] <- "cntry"
names(dataset_ppe)[names(dataset_ppe) == "ORDINAL CCPI Overall: Effectiveness of Country regarding Paris Agreement"] <- "effect_CCPI_ORD"
names(dataset_ppe)[names(dataset_ppe) =="METRIC CCPI Overall: Effectiveness of Country regarding Paris Agreement"] <- "effect_CCPI_METRIC"
names(dataset_ppe)[names(dataset_ppe) == "METRIC CCPI Climate Policy"] <- "clim_pol_CCPI_METRIC"
names(dataset_ppe)[names(dataset_ppe) == "METRIC CCPI GHG Emissions"] <- "ghg_emiss_CCPI_METRIC"
names(dataset_ppe)[names(dataset_ppe) == "ORDINAL Climate Action Tracker (EU countries not differentiated)"] <- "effect_climact_trak_ORD"
names(dataset_ppe)[names(dataset_ppe) == "Last election"] <- "last_elect_yr"
names(dataset_ppe)[names(dataset_ppe) == "Gov econ. Direction; Left 0 - Right 10 [if several parties -> mean of the parties w/o weighting based on seats]"] <- "gov_lr_econ"
names(dataset_ppe)[names(dataset_ppe) == "Green parties seat percentage"] <- "green_seat_perc"
names(dataset_ppe)[names(dataset_ppe) == "Conservative parties seat percentag"] <- "cons_seat_perc"
names(dataset_ppe)[names(dataset_ppe) == "Fossil fuel consumption per capita (kwh), 2022"] <- "fos_fuel_consump_pc_2022"
names(dataset_ppe)[names(dataset_ppe)== "Renewables consumption per capita (kwh), 2022"] <- "renew_consump_pc_2022"
names(dataset_ppe)[names(dataset_ppe)== "(Very much like me) 1-6 (Unlike me) Public perception of climate issue (specify question) #ESS [Now I will briefly describe some people. Please listen to each description and tell me how much each person is or is not like you. Use this card for your answer. She/he strongly believes that people should care for nature. Looking after the environment is important to her/him.\n\nValue\tCategory\n1\tVery much like me\n2\tLike me\n3\tSomewhat like me\n4\tA little like me\n5\tNot like me\n6\tNot like me at all\n7\tRefusal*\n8\tDon't know*\n9\tNo answer*]"] <- "pub_perc_clim_ESS"
names(dataset_ppe)[names(dataset_ppe)=="ESS switched"] <- "pub_perc_clim_ESS_SWITCHED"
names(dataset_ppe)[names(dataset_ppe)=="(not at all concerned) 1-5 (very concerned) #ISSP: Q6 How concerned in environmental issues?"] <- "pub_perc_clim_ISSP"
names(dataset_ppe)[names(dataset_ppe)=="(not serious at all) 0-4 (very serious) Lapop: Seriousness of Climate Change env2b; already standardised"] <- "pub_perc_clim_LAPOP"
names(dataset_ppe)[names(dataset_ppe)=="(0-100%) Share of people who believe in climate change and think it's a serious threat to humanity  -> a bit less precise; which is why it will not be combined with other existing data  [https://ourworldindata.org/grapher/share-believe-climate]"]<-"pub_perc_clim_OWD"
names(dataset_ppe)[names(dataset_ppe)=="Other sources (see comment)"] <- "pub_perc_clim_oth_sour"
names(dataset_ppe)[names(dataset_ppe)=="Standardised Public Opinion"] <-"pub_perc_clim_stand_fin"
names(dataset_ppe)[names(dataset_ppe)=="Public opionion consilidated: 1: Not concerned about environmental issues / do not care about nature & environment; 2: Moderately concerned about environmental issues / moderately care for nature & enivornment; 3: Concerned about environmental issues / cares about nature & environment; thus: ESS 1&2 = 1, 3 = 2, 4&5 = 3; ISSP 1&2= 1, 3 = 2; 4&5 = 3."]<- "pubc_perc_old_cons"
names(dataset_ppe)[names(dataset_ppe) == "ETS"] <- "ets_dummy"
names(dataset_ppe)[names(dataset_ppe) == "Subsidies"] <- "subsid_dummy"
names(dataset_ppe)[names(dataset_ppe) == "Carbon Taxes"] <- "carb_tax_dummy"
names(dataset_ppe)[names(dataset_ppe) == "Bans on Fossil Fuels (Source: Wikipedia, if you have a better one, please let me know)"] <- "ban_fos_fuel"
names(dataset_ppe)[names(dataset_ppe) == "EU Dummy"] <- "eu_dummy"


``` 
Visualisations of variables:
```{r}
### 1st variable

#dataset_ppe_filtered <- dataset_ppe[!is.na(dataset_ppe$effect_CCPI_ORD), ]

effect_levels <- c("Very Low", "Low", "Medium", "High")

dataset_ppe$effect_CCPI_ORD <- factor(dataset_ppe$effect_CCPI_ORD, levels = effect_levels)

color_palette <- c("#8B0000", "#FF4500", "#FFD700", "#90EE90")

ccpi_ord <- ggplot(dataset_ppe, aes(x = effect_CCPI_ORD, fill = effect_CCPI_ORD)) +
  geom_bar(color = "black") +
  labs(title = "Effectiveness of Countries regarding Paris Agreement (Ordinal CCPI)",
       x = "Effectiveness Levels",
       y = "Count") +
  scale_x_discrete(drop = FALSE) +  # Ensure all factor levels are shown on the x-axis
  theme_minimal() +
  scale_fill_manual(values = color_palette) + # Apply the custom color palette
  theme(
    axis.title.x = element_text(margin = margin(t = 10))  # Add margin to the top of the x-axis title
  )

print(ccpi_ord)

```

```{r}

### Variable 2:

df <- dataset_ppe %>%
  filter(!is.na(effect_CCPI_METRIC)) %>%
  arrange(effect_CCPI_METRIC)

# Create a color gradient from dark red to light green
color_palette <- colorRampPalette(c("#8B0000", "#FF4500", "#FFD700", "#90EE90"))

# Create the scatter plot with ordered countries
ccpi_met <- ggplot(df, aes(x = reorder(cntry, effect_CCPI_METRIC), y = effect_CCPI_METRIC)) +
  geom_point(aes(color = effect_CCPI_METRIC), size = 3) +  # Color points by CCPI score
  scale_color_gradientn(colors = color_palette(100)) +  # Apply gradient
  labs(title = "CCPI Overall: Effectiveness of Country regarding Paris Agreement",
       x = "Country", y = "CCPI Score") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +  # Rotate x-axis labels
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +  # Adjust x-axis labels
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, margin = margin(t = 0.5, r = 0, b = 0, l = 0)))   # 

print(ccpi_met)



```

```{r}
### Variable 3
df <- dataset_ppe %>%
  filter(!is.na(clim_pol_CCPI_METRIC)) %>%
  arrange(clim_pol_CCPI_METRIC)

# Create scatterplot with country labels
ccpi_met_pol <- ggplot(df, aes(x = reorder(cntry, clim_pol_CCPI_METRIC), y = clim_pol_CCPI_METRIC)) +
  geom_point(aes(color = clim_pol_CCPI_METRIC), size = 3) +  # Color points by CCPI score
  scale_color_gradientn(colors = color_palette(100)) +  # 
  labs(title = "CCPI Climate Policy: Assessment of policy selection",
       x = "Country", y = "CCPI Score Policy") +
  theme_minimal() +
  scale_x_discrete(guide = guide_axis(n.dodge = 2))  +
   theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, margin = margin(t = 0.5, r = 0, b = 0, l = 0)))   # Rotate x-axis labels and adjust spacing

print(ccpi_met_pol)
```
```{r}

### Variable 4: METRIC CCPI GHG Emissions
df <- dataset_ppe %>%
  filter(!is.na(ghg_emiss_CCPI_METRIC)) %>%
  arrange(ghg_emiss_CCPI_METRIC)

# Create scatterplot with country labels
ccpi_met_emiss <- ggplot(df, aes(x = reorder(cntry, ghg_emiss_CCPI_METRIC), y = ghg_emiss_CCPI_METRIC)) +
  geom_point(aes(color = ghg_emiss_CCPI_METRIC), size = 3) +  # Color points by CCPI score
  scale_color_gradientn(colors = color_palette(100)) +  
  labs(title = "CCPI GHG Emissions: Assessment of countries' emissions",
       x = "Country", y = "CCPI Score GHG Emissions") +
  theme_minimal() +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, margin = margin(t = 0.5, r = 0, b = 0, l = 0)))   #   #

print(ccpi_met_emiss)

```

## VIELLEICHT NOCH MACHEN ABER NICHT SO WICHTIG
```{r}

### Variable 5: ORDINAL Climate Action Tracker

dataset_ppe_filtered_2 <- dataset_ppe[!is.na(dataset_ppe$effect_climact_trak_ORD), ]

effect_levels_CAT <- c("Critically Insufficient", "Highly Insufficient", "Insufficient", "Almost Sufficient")

dataset_ppe_filtered_2$effect_climact_trak_ORD <- factor(dataset_ppe_filtered_2$effect_climact_trak_ORD, levels = effect_levels_CAT)

CAT_ord <- ggplot(dataset_ppe_filtered_2, aes(x = effect_climact_trak_ORD)) +
  geom_bar(fill = "skyblue", color = "black") +
  labs(title = "Effectiveness of Countries regarding Paris Agreem. (Ord. Climate Action Tracker)",
       x = "Effectiveness Levels",
       y = "Count") +
  scale_x_discrete(drop = FALSE)  # Ensure all factor levels are shown on the x-axis

print(CAT_ord)



### Variable 6: Gov econ. Direction;
lr_econ_gov <- na.omit(dataset_ppe$gov_lr_econ)
df <- data.frame(Country = countries[!is.na(dataset_ppe$gov_lr_econ)], 
                 LeftRight_Econ_Dir_GOV = lr_econ_gov)

# Create scatterplot with country labels
lr_gov <- ggplot(df, aes(x = Country, y = LeftRight_Econ_Dir_GOV)) +
  geom_point(color = "skyblue", size = 3) +  # Customize point appearance
  labs(title = "Governments' economic direction on left-right spectrum",
       x = "Country", y = "Government on Left-Right Spectrum") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, margin = margin(t = 0.5, r = 0, b = 0, l = 0))) +  # Rotate x-axis labels and adjust spacing
  scale_x_discrete(guide = guide_axis(n.dodge = 2))  #

print(lr_gov)



### Variable 7: Greens seats


### Variable 8: Conservative seats



### Variable 9: Fossil Fuel Consumption
fos_fuel_consump <- na.omit(dataset_ppe$fos_fuel_consump_pc_2022)
df <- data.frame(Country = countries[!is.na(dataset_ppe$fos_fuel_consump_pc_2022)], 
                 Fossil_Fuel_Consump = fos_fuel_consump)

# Create scatterplot with country labels
fossil_fuel_consumption <- ggplot(df, aes(x = Country, y = Fossil_Fuel_Consump)) +
  geom_point(color = "skyblue", size = 3) +  # Customize point appearance
  labs(title = "Fossil Fuel Consumption p.c.",
       x = "Country", y = "Fossil Fuel Consumptions in kwh") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, margin = margin(t = 0.5, r = 0, b = 0, l = 0))) +  # Rotate x-axis labels and adjust spacing
  scale_x_discrete(guide = guide_axis(n.dodge = 2))  #

print(fossil_fuel_consumption)



### Variable 10: Renewables consumption 
renew_consump <- na.omit(dataset_ppe$renew_consump_pc_2022)
df <- data.frame(Country = countries[!is.na(dataset_ppe$renew_consump_pc_2022)], 
                 Renewables_Consump = renew_consump)

# Create scatterplot with country labels
renewables_consumption <- ggplot(df, aes(x = Country, y = Renewables_Consump)) +
  geom_point(color = "skyblue", size = 3) +  # Customize point appearance
  labs(title = "Renewables Consumption p.c.",
       x = "Country", y = "Renewables Consumptions in kwh") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, margin = margin(t = 0.5, r = 0, b = 0, l = 0))) +  # Rotate x-axis labels and adjust spacing
  scale_x_discrete(guide = guide_axis(n.dodge = 2))  #

print(renewables_consumption)



### Variable 13: Public Opinions consolidated 
dataset_ppe_filtered_3 <- dataset_ppe[!is.na(dataset_ppe$pub_perc_ALL), ]

pub_opin_CONSOL <- c("1", "2", "3")

dataset_ppe_filtered_3$pub_perc_ALL <- factor(dataset_ppe_filtered_3$pub_perc_ALL, levels = pub_opin_CONSOL)

pub_opin_con_ORD <- ggplot(dataset_ppe_filtered_3, aes(x = pub_perc_ALL)) +
  geom_bar(fill = "skyblue", color = "black") +
  labs(title = "Public opinion on environmental issues consolidated",
       x = "Levels of Concern",
       y = "Count") +
  scale_x_discrete(drop = FALSE)  # Ensure all factor levels are shown on the x-axis

print(pub_opin_con_ORD)

```

```{r}

### Variable 14: ETS Dummy
dataset_ppe_filtered <- dataset_ppe[!is.na(dataset_ppe$ets_dummy), ]

# Rename factor levels to "No" and "Yes"
dataset_ppe_filtered$ets_dummy_2 <- factor(dataset_ppe_filtered$ets_dummy, levels = c(0, 1), labels = c("No", "Yes"))

# Create the plot
ets_d <- ggplot(dataset_ppe_filtered, aes(x = ets_dummy_2)) +
  geom_bar(fill = "skyblue", color = "black") +
  labs(title = "Existence of an Emission Trading System",
       x = "",
       y = "") +  # Remove the "Count" label on the y-axis
  theme_minimal() +
  scale_x_discrete(drop = FALSE) +  # Ensure all factor levels are shown on the x-axis
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5)  # Add exact count on the bars

print(ets_d)


```

```{r}
### Variable 15: Subsidies Dummy
dataset_ppe_filtered_5 <- dataset_ppe[!is.na(dataset_ppe$subsid_dummy), ]

dataset_ppe_filtered_5$subsid_dummy_2 <- factor(dataset_ppe_filtered_5$subsid_dummy, levels = c(0, 1), labels = c("No", "Yes"))

sub_d <- ggplot(dataset_ppe_filtered_5, aes(x = subsid_dummy_2)) +
  geom_bar(fill = "#85bb65", color = "black") +
  labs(title = "Existence of Subsidies for Clean Energy/Renewables",
       x = "",
       y = "") +
  theme_minimal() +
  scale_x_discrete(drop = FALSE) +  # Ensure all factor levels are shown on the x-axis
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5) 

print(sub_d)


```

```{r}
### Variable 16: Carbon Tax Dummy
dataset_ppe_filtered_6 <- dataset_ppe[!is.na(dataset_ppe$carb_tax_dummy), ]

dataset_ppe_filtered_6$carb_tax_dummy_2 <- factor(dataset_ppe_filtered_6$carb_tax_dummy, levels = c(0, 1), labels = c("No", "Yes"))

carb_tax_d <- ggplot(dataset_ppe_filtered_6, aes(x = carb_tax_dummy_2)) +
  geom_bar(fill = "#625D5D", color = "black") +
  labs(title = "Existence of Carbon Taxes",
       x = "",
       y = "") +
  theme_minimal() +
  scale_x_discrete(drop = FALSE) + # Ensure all factor levels are shown on the x-axis
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5) 
print(carb_tax_d)

```

```{r}
### Variable 17: Bans on Fossil Fuels Dummy
dataset_ppe_filtered_7 <- dataset_ppe[!is.na(dataset_ppe$ban_fos_fuel), ]

dataset_ppe_filtered_7$ban_fos_fuel_2 <- factor(dataset_ppe_filtered_6$ban_fos_fuel, levels = c(0, 1), labels = c("No", "Yes"))

ban_fossil_fuel <- ggplot(dataset_ppe_filtered_7, aes(x = ban_fos_fuel_2)) +
  geom_bar(fill = "#B38614", color = "black") +
  labs(title = "Existence of Bans on Fossil Fuels",
       x = "",
       y = "") +
  theme_minimal() +
  scale_x_discrete(drop = FALSE) +  # Ensure all factor levels are shown on the x-axis
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5) 
print(ban_fossil_fuel)

```



Regressions for Instruments
```{r}
# ETS
library(pscl)
ets_model <- glm(formula = ets_dummy ~ gov_lr_econ + green_seat_perc + cons_seat_perc + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, family ="binomial", data= dataset_ppe)
summary(ets_model)

ets_model2 <- glm(formula = ets_dummy ~ gov_lr_econ + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, family ="binomial", data= dataset_ppe)
summary(ets_model2)
# Odds Ratio
exp(coef(ets_model))
pR2(ets_model)

library(texreg)
texreg(ets_model2, digits=5, leading.zero = FALSE)



ets_model3 <- glm(formula = ets_dummy ~  green_seat_perc+ fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, family ="binomial", data= dataset_ppe)
summary(ets_model3)

ets_model4 <- glm(formula = ets_dummy ~  cons_seat_perc+ fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, family ="binomial", data= dataset_ppe)
summary(ets_model4)


# Subsidies
subsidies_model <- glm(formula = subsid_dummy ~ gov_lr_econ + green_seat_perc + cons_seat_perc + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, family ="binomial", data= dataset_ppe)
summary(subsidies_model)

subsidies_model_2 <- glm(formula = subsid_dummy ~ gov_lr_econ+ fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, family ="binomial", data= dataset_ppe)
summary(subsidies_model_2)

texreg(subsidies_model_2, digits=5, leading.zero = FALSE)

subsidies_model_3 <- glm(formula = subsid_dummy ~ green_seat_perc+ fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, family ="binomial", data= dataset_ppe)
summary(subsidies_model_3)

subsidies_model_4 <- glm(formula = subsid_dummy ~ cons_seat_perc+ fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, family ="binomial", data= dataset_ppe)
summary(subsidies_model_4)
# Odds Ratio
exp(coef(subsidies_model))
pR2(subsidies_model)

# Carbon Tax
carbontax_model <- glm(formula = carb_tax_dummy ~ gov_lr_econ + green_seat_perc + cons_seat_perc + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, family ="binomial", data= dataset_ppe)
summary(carbontax_model)

carbontax_model_2 <- glm(formula = carb_tax_dummy ~ gov_lr_econ  + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, family ="binomial", data= dataset_ppe)
summary(carbontax_model_2)

texreg(carbontax_model_2, digits=5, leading.zero = FALSE)

carbontax_model_3 <- glm(formula = carb_tax_dummy ~ green_seat_perc  + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, family ="binomial", data= dataset_ppe)
summary(carbontax_model_3)

carbontax_model_4 <- glm(formula = carb_tax_dummy ~ cons_seat_perc  + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, family ="binomial", data= dataset_ppe)
summary(carbontax_model_4)

# Odds Ratio
exp(coef(carbontax_model))
subsidies_model
pR2(carbontax_model)

# Fossil Fuel Ban
fossilfuel_ban_model <- glm(formula = ban_fos_fuel ~ gov_lr_econ + green_seat_perc + cons_seat_perc + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, family ="binomial", data= dataset_ppe)
summary(fossilfuel_ban_model)

fossilfuel_ban_model_2 <- glm(formula = ban_fos_fuel ~ gov_lr_econ + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, family ="binomial", data= dataset_ppe)
summary(fossilfuel_ban_model_2)

texreg(fossilfuel_ban_model_2, digits=5, leading.zero = FALSE)

fossilfuel_ban_model_3 <- glm(formula = ban_fos_fuel ~ green_seat_perc + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, family ="binomial", data= dataset_ppe)
summary(fossilfuel_ban_model_3)

fossilfuel_ban_model_4 <- glm(formula = ban_fos_fuel ~ cons_seat_perc + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, family ="binomial", data= dataset_ppe)
summary(fossilfuel_ban_model_4)
# Odds Ratio
exp(coef(fossilfuel_ban_model))
pR2(fossilfuel_ban_model)

```


Regression for Effectiveness

```{r}
library(MASS)
library("glm.predict")
# IPCC MMASS# IPCC Metric GENERAL
IPCC_metr_model_all <- lm(effect_CCPI_METRIC ~ ets_dummy + subsid_dummy + carb_tax_dummy + ban_fos_fuel+ gov_lr_econ + green_seat_perc + cons_seat_perc + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, data= dataset_ppe)
summary(IPCC_metr_model_all)

#maybe: texreg(IPCC_metr_model_all, digits=5, leading.zero = FALSE)

#ets model
IPCC_metr_model_ets <- lm(effect_CCPI_METRIC ~ ets_dummy + gov_lr_econ + green_seat_perc + cons_seat_perc + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, data= dataset_ppe)
summary(IPCC_metr_model_ets)
# maybe: texreg(IPCC_metr_model_ets, digits=5, leading.zero = FALSE)

# subsidies
IPCC_metr_model_subs <- lm(effect_CCPI_METRIC ~ subsid_dummy + gov_lr_econ + green_seat_perc + cons_seat_perc + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, data= dataset_ppe)
summary(IPCC_metr_model_subs)
# maybe: texreg(IPCC_metr_model_subs, digits=5, leading.zero = FALSE)

# carbon tax
IPCC_metr_model_carbtax <- lm(effect_CCPI_METRIC ~ carb_tax_dummy + gov_lr_econ + green_seat_perc + cons_seat_perc + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, data= dataset_ppe)
summary(IPCC_metr_model_carbtax)

# ban fossil fuel
IPCC_metr_model_banfosfuel <- lm(effect_CCPI_METRIC ~ ban_fos_fuel + gov_lr_econ + green_seat_perc + cons_seat_perc + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, data= dataset_ppe)
summary(IPCC_metr_model_banfosfuel)


### models with only one political variable
# all
IPCC_metr_model_all_govlrecon <- lm(effect_CCPI_METRIC ~ ets_dummy + subsid_dummy + carb_tax_dummy + ban_fos_fuel+ gov_lr_econ + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, data= dataset_ppe)
summary(IPCC_metr_model_all_govlrecon)

IPCC_metr_model_all_green <- lm(effect_CCPI_METRIC ~ ets_dummy + subsid_dummy + carb_tax_dummy + ban_fos_fuel+ green_seat_perc + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, data= dataset_ppe)
summary(IPCC_metr_model_all_green)

IPCC_metr_model_all_cons <- lm(effect_CCPI_METRIC ~ ets_dummy + subsid_dummy + carb_tax_dummy + ban_fos_fuel+ cons_seat_perc + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, data= dataset_ppe)
summary(IPCC_metr_model_all_green)

# ets
IPCC_metr_model_ets_govlrecon  <- lm(effect_CCPI_METRIC ~ ets_dummy + gov_lr_econ + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, data= dataset_ppe)
summary(IPCC_metr_model_ets_govlrecon)
texreg(IPCC_metr_model_ets_govlrecon, digits=5, leading.zero = FALSE)

IPCC_metr_model_ets_green <- lm(effect_CCPI_METRIC ~ ets_dummy + green_seat_perc + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, data= dataset_ppe)
summary(IPCC_metr_model_ets_green)

IPCC_metr_model_ets_cons <- lm(effect_CCPI_METRIC ~ ets_dummy + cons_seat_perc + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, data= dataset_ppe)
summary(IPCC_metr_model_ets_cons)

#subsidies
IPCC_metr_model_subs_govlrecon  <- lm(effect_CCPI_METRIC ~ subsid_dummy + gov_lr_econ + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, data= dataset_ppe)
summary(IPCC_metr_model_subs_govlrecon)
texreg(IPCC_metr_model_subs_govlrecon, digits=5, leading.zero = FALSE)

IPCC_metr_model_subs_green <- lm(effect_CCPI_METRIC ~ subsid_dummy + green_seat_perc + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, data= dataset_ppe)
summary(IPCC_metr_model_subs_green)

IPCC_metr_model_ets_cons <- lm(effect_CCPI_METRIC ~ subsid_dummy + cons_seat_perc + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, data= dataset_ppe)
summary(IPCC_metr_model_ets_cons)

#carbon tax
IPCC_metr_model_carbtax_govlrecon  <- lm(effect_CCPI_METRIC ~ carb_tax_dummy + gov_lr_econ + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, data= dataset_ppe)
summary(IPCC_metr_model_carbtax_govlrecon)
texreg(IPCC_metr_model_carbtax_govlrecon, digits=5, leading.zero = FALSE)

IPCC_metr_model_carbtax_green <- lm(effect_CCPI_METRIC ~ carb_tax_dummy + green_seat_perc + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, data= dataset_ppe)
summary(IPCC_metr_model_carbtax_green)

IPCC_metr_model_carbtax_cons <- lm(effect_CCPI_METRIC ~ carb_tax_dummy + cons_seat_perc + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, data= dataset_ppe)
summary(IPCC_metr_model_carbtax_cons)

#Ban fossil fuel
IPCC_metr_model_banfosfuel_govlrecon  <- lm(effect_CCPI_METRIC ~ ban_fos_fuel + gov_lr_econ + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, data= dataset_ppe)
summary(IPCC_metr_model_banfosfuel_govlrecon)
texreg(IPCC_metr_model_banfosfuel_govlrecon, digits=5, leading.zero = FALSE)

IPCC_metr_model_banfosfuel_green <- lm(effect_CCPI_METRIC ~ ban_fos_fuel + green_seat_perc + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, data= dataset_ppe)
summary(IPCC_metr_model_banfosfuel_green)

IPCC_metr_model_banfosfuel_cons <- lm(effect_CCPI_METRIC ~ ban_fos_fuel + cons_seat_perc + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, data= dataset_ppe)
summary(IPCC_metr_model_banfosfuel_cons)



# IPCC Metric Climate Policy 
IPCC_metr_climPol_model <- lm(clim_pol_CCPI_METRIC ~ ets_dummy + subsid_dummy + carb_tax_dummy + ban_fos_fuel+ gov_lr_econ + green_seat_perc + cons_seat_perc + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, data= dataset_ppe)
summary(IPCC_metr_climPol_model)

# IPCC Metric GHG Emissions 
IPCC_metr_ghg_emiss_model <- lm(ghg_emiss_CCPI_METRIC ~ ets_dummy + subsid_dummy + carb_tax_dummy + ban_fos_fuel+ gov_lr_econ + green_seat_perc + cons_seat_perc + fos_fuel_consump_pc_2022 + renew_consump_pc_2022 +pub_perc_clim_stand_fin +eu_dummy, data= dataset_ppe)
summary(IPCC_metr_ghg_emiss_model)

```

___________________________________________________________________________________________________
Diagnostics

```{r}
# Linear Regression 1 - CCPI General Metric Model

# Residual plots
par(mfrow = c(2, 2))
plot(IPCC_metr_model)

# Durbin-Watson Test
library(lmtest)
dwtest(IPCC_metr_model)

# Breusch-Pagan Test
library(lmtest)
bptest(IPCC_metr_model)

# Shapiro-Wilk Test
shapiro.test(residuals(IPCC_metr_model))

# Cook's Distance
plot(IPCC_metr_model, which = 4)

# VIF
library(car)
vif(IPCC_metr_model)


```

### Plot 1 Residuals vs Fitted
Generally the plot shows barely a sign of heteroskedascity, however the slight 
bend between 50 and 60 of the fitted values might indicate a non-linear 
relationship. It remains the questions if this should be dealt with by using 
log-transformations of the dependent variable or interaction/polynomial terms
to account for non-linearity. However, the large residuals between -15 and 15 
suggest that the model may not be properly specified.

(The fitted values for a linear regression model are the predicted values of the
outcome variable for the data that is used to fit the model.; In linear regression, 
the residuals are the differences between each of the fitted values and true 
values of the outcome variable.)

### Plot 2 Normal Q-Q
With the normal Q-Q plot, there is only a slight deviance from the 45-degree line
between the 1 and 2 Theoretical Quantile. (If this is a significant deviation
is another question.)

### Plot 3 Scale-Location 
One could argue the the red line is roughly horizontal, which, thus, implies
that the average size of the standardised residuals do not vary too much along
the fitted values.
However, the spread of the observations along that red line changes, thus, more
observations can be found in the middle between 50 and 65, which might pose a 
problem. Further tests should show, if this needs to be addressed.

### Plot 4 Residuals vs. Leverage
The good news here is that no observation crosses Cook's distance thresholds.
Although there are two points with high leverage (at 0.8), they might not be
too influential since they do not have large residuals. Also, the standardised
residuals seem to still be reasonably between -2 and 2.

(Leverage measures how far an observation's values of the independent variables 
are from the mean values of those variables. Leverage refers to the extent to which 
the coefficients in the regression model would change if a particular observation
was removed from the dataset. Standardized residuals refer to the standardized 
difference between a predicted value for an observation and the actual value of 
the observation.)


### Durbin Watson Test
DW = 2.1469, p-value = 0.6951
As the durbon watson coefficient is at 2.1469 it falls between the normal the 
normal range, however, it is insignificant, thus autocorrelation cannot be 
ruled out.

### Breusch-Pagan Test
BP = 15.909, df = 11, p-value = 0.1446
The Breusch-Pagan test yields an insignificant value, thus, no significant
heteroscedasticity can be found.

### Shapiro Wilk Test
W = 0.97957, p-value = 0.6164
The non-significant results of the Shapiro-Wilk Test indicate that there is no
significant sign of non-normality of residuals.

### Cook's distance
While there are some spikes in the graph, none of the observations lie above
the threshold of 1, which would imply, as I argue, that there are not too 
influential points.

### VIF
The Variance Inflation Factor indicates no significant multicollinearity, as no
value is above 10.



```{r}
library(broom)
```

```{r}
# Binomial Logistic Regression - ETS model
ets_model

# Deviance residuals vs. fitted values
ggplot(data = augment(ets_model), aes(.fitted, .resid)) +
  geom_point() +
  labs(x = "Fitted values", y = "Deviance Residuals") +
  geom_smooth(se = FALSE, method = "loess")
```

```{r}
# Binomial Logistic Regression - Subsidies model
subsidies_model
```

```{r}
# Binomial Logistic Regression - Carbon Tax model
carbontax_model
```

```{r}
# Binomial Logistic Regression - Fossil Fuel Ban
fossilfuel_ban_model
```